<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Poker Card Designer</title>
  <meta name="app-version" content="1.0.0" />
  <link rel="stylesheet" href="styles/main.css" />
  <link rel="icon" type="image/png" href="./favicon.png" />

  <!-- Google WebFont Loader (for any Google Fonts family name) -->
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>

  <!-- JSZip for exporting all cards as a single ZIP file -->
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <!-- Marked for rendering help markdown content -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>
<button type="button" id="helpLauncher" class="help-fab" title="Open help">?</button>
<button type="button" id="bugReportLauncher" class="help-fab bug-fab" title="Report a bug">üêû</button>
<div class="app">
  <div class="sidebar">
    <div class="title-row">
      <h1>Card Designer</h1>
      <button type="button" id="fullResetButton" class="reset-icon-button" title="Start Over">‚Üª</button>
    </div>

    <!-- Card selection -->
    <div class="panel">
      <div class="panel-header">
        <span>Card navigation</span>
      </div>
      <div class="field-row">
        <div class="field" style="flex:1">
          <label for="suitSelect">Suit</label>
          <select id="suitSelect">
            <option value="spades">Spades (‚ô†)</option>
            <option value="hearts">Hearts (‚ô•)</option>
            <option value="clubs">Clubs (‚ô£)</option>
            <option value="diamonds">Diamonds (‚ô¶)</option>
          </select>
        </div>
        <div class="field" style="flex:1">
          <label for="rankSelect">Rank</label>
          <select id="rankSelect"></select>
        </div>
      </div>



    </div>
	
	<!-- Face image for current card -->
	<div class="panel">
	  <div class="panel-header">
		  <span>Face image (current card)</span>
		  <span id="bulkUploadBadge" class="badge clickable">‚¨ÜÔ∏è bulk</span>
		</div>


	  <div class="field">
		<div class="file-input-label">Image for this suit / rank</div>

		<!-- Single image upload -->
		<div id="faceImageWrapper" class="file-display">
		  <span id="faceImageLabel" class="file-label clickable">Click to add‚Ä¶</span>
		  <input id="faceImageInput" type="file" accept="image/*" style="display:none">
		</div>

	  </div>

	  <div class="two-col">
		<div class="field">
		  <label for="faceScaleInput">Zoom</label>
		  <input id="faceScaleInput" type="range" min="0.2" max="3" step="0.05" value="1">
		</div>
                <div class="field">
                  <label for="faceRotationInput">Rotation (¬∞)</label>
                  <input id="faceRotationInput" type="range" min="-180" max="180" step="0.1" value="0">
                </div>
	  </div>

	  <div class="field-row">
		<div class="checkbox-row">
		  <input type="checkbox" id="faceFlipHCheckbox">
		  <label for="faceFlipHCheckbox">Flip horizontally</label>
		</div>
	  </div>

	  <div class="field-row">
		<div class="checkbox-row">
		  <input type="checkbox" id="faceFlipVCheckbox">
		  <label for="faceFlipVCheckbox">Flip vertically</label>
		</div>
	  </div>

	  <div class="field-row">
		<button type="button" class="secondary" id="resetFaceTransformButton">Reset transform</button>
	  </div>

    </div>

      <div class="panel collapsed">
        <div class="panel-header collapsible">
          <span>Ability text</span>
          <div class="header-actions">
            <button type="button" id="resetAbilityButton" class="reset-icon-button" title="Reset ability styling">‚Üª</button>
            <span class="chevron">‚ñæ</span>
          </div>
        </div>

        <div class="field">
          <label for="abilityMarkdownInput">Markdown content (per card)</label>
          <textarea id="abilityMarkdownInput" rows="6" placeholder="Type ability text in markdown‚Ä¶"></textarea>
        </div>

        <div class="hint">Reset only restores shared styling; per-card markdown content stays as-is.</div>

        <div class="two-col">
          <div class="field">
            <label>Header font</label>
            <div id="abilityHeaderFontWrapper" class="font-family-box">
              <span id="abilityHeaderFontLabel" class="font-family-text"></span>
              <span class="font-family-icon">üîé</span>
            </div>
          </div>
          <div class="field">
            <label>Body font</label>
            <div id="abilityBodyFontWrapper" class="font-family-box">
              <span id="abilityBodyFontLabel" class="font-family-text"></span>
              <span class="font-family-icon">üîé</span>
            </div>
          </div>
        </div>

        <div class="two-col">
          <div class="field">
            <label for="abilityHeaderFontSizeInput">Header size (px)</label>
            <input id="abilityHeaderFontSizeInput" type="number" min="10" max="120" value="28">
          </div>
          <div class="field">
            <label for="abilityBodyFontSizeInput">Body size (px)</label>
            <input id="abilityBodyFontSizeInput" type="number" min="8" max="120" value="20">
          </div>
        </div>

        <div class="two-col">
          <div class="field">
            <label for="abilityHeaderFontWeightSelect">Header weight</label>
            <select id="abilityHeaderFontWeightSelect">
              <option value="400">400</option>
              <option value="500">500</option>
              <option value="600">600</option>
              <option value="700" selected>700</option>
              <option value="800">800</option>
              <option value="900">900</option>
            </select>
          </div>
          <div class="field">
            <label for="abilityBodyFontWeightSelect">Body weight</label>
            <select id="abilityBodyFontWeightSelect">
              <option value="300">300</option>
              <option value="400" selected>400</option>
              <option value="500">500</option>
              <option value="600">600</option>
              <option value="700">700</option>
            </select>
          </div>
        </div>

        <div class="two-col">
          <div class="field">
            <label for="abilityTextColorInput">Text color</label>
            <input id="abilityTextColorInput" type="color" value="#000000">
          </div>
          <div class="field">
            <label for="abilityTextOpacityInput">Text opacity</label>
            <input id="abilityTextOpacityInput" type="range" min="0" max="1" step="0.05" value="1">
          </div>
        </div>

        <div class="two-col">
          <div class="field">
            <label for="abilityPlacementSelect">Placement</label>
            <select id="abilityPlacementSelect">
              <option value="top">Top</option>
              <option value="bottom" selected>Bottom</option>
            </select>
          </div>
          <div class="field">
            <label for="abilityAlignmentSelect">Alignment</label>
            <select id="abilityAlignmentSelect">
              <option value="left">Left</option>
              <option value="center" selected>Center</option>
              <option value="right">Right</option>
            </select>
          </div>
        </div>

        <div class="field-row">
          <div class="checkbox-row">
            <input type="checkbox" id="abilityMirrorCheckbox">
            <label for="abilityMirrorCheckbox">Add mirrored copy on opposite side</label>
          </div>
        </div>

        <div class="two-col">
          <div class="field">
            <label for="abilityWidthInput">Panel width (%)</label>
            <input id="abilityWidthInput" type="range" min="40" max="160" step="1" value="120">
          </div>
          <div class="field">
            <label for="abilityBackgroundInput">Background</label>
            <div class="inline-field">
              <input id="abilityBackgroundInput" type="color" value="#ffffff">
              <label class="inline-label" for="abilityBackgroundOpacityInput">Opacity:</label>
              <input id="abilityBackgroundOpacityInput" type="range" min="0" max="1" step="0.05" value="0">
            </div>
          </div>
          <div class="field">
            <label for="abilityHeightModeSelect">Height</label>
            <select id="abilityHeightModeSelect">
              <option value="auto" selected>Auto (expand)</option>
              <option value="fixed">Fixed</option>
            </select>
          </div>
        </div>

        <div class="two-col hidden" id="abilityFixedControls">
          <div class="field">
            <label for="abilityFixedHeightInput">Fixed height (px)</label>
            <input id="abilityFixedHeightInput" type="number" min="50" max="600" value="180">
          </div>
          <div class="field">
            <label for="abilityOverflowSelect">Overflow behavior</label>
            <select id="abilityOverflowSelect">
              <option value="shrink" selected>Shrink to fit</option>
              <option value="hidden">Hide overflow</option>
              <option value="overflow">Allow overflow</option>
            </select>
          </div>
        </div>
      </div>

    <!-- Font settings -->
    <div class="panel">
      <div class="panel-header collapsible">
        <span>Rank/Index font</span>
        <div class="header-actions">
          <button type="button" id="resetFontsButton" class="reset-icon-button" title="Reset fonts">‚Üª</button>
          <span class="chevron">‚ñæ</span>
        </div>
      </div>

		<div class="field-row">
		  <div id="fontFamilyWrapper" class="font-family-box">
  <span id="fontFamilyInput" class="font-family-text"></span>
  <span class="font-family-icon">üîé</span>
</div>



		</div>


      <div class="two-col">
        <div class="field">
          <label for="fontSizeInput">Size (px)</label>
          <input id="fontSizeInput" type="number" min="16" max="180" value="72">
        </div>
        <div class="field">
          <label for="fontWeightSelect">Weight</label>
          <select id="fontWeightSelect">
            <option value="400">400</option>
            <option value="500">500</option>
            <option value="600">600</option>
            <option value="700" selected>700</option>
            <option value="800">800</option>
            <option value="900">900</option>
          </select>
        </div>
      </div>

      <div class="field">
        <label for="fontColorModeSelect">Color mode</label>
        <select id="fontColorModeSelect">
          <option value="single">Single color</option>
          <option value="bi">Bi-color (red / black)</option>
          <option value="perSuit">Per suit</option>
        </select>
      </div>

      <div class="color-mode-group" id="fontSingleGroup">
        <div class="color-picker-row">
          <span>All suits</span>
          <div class="color-picker">
            <input id="fontColorInput" type="color" value="#000000">
            <button type="button" id="fontColorEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
      </div>

      <div class="color-mode-group" id="fontBiColorGroup">
        <div class="color-picker-row">
          <span>Black suits</span>
          <div class="color-picker">
            <input id="fontColorBlackInput" type="color" value="#000000">
            <button type="button" id="fontColorBlackEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Red suits</span>
          <div class="color-picker">
            <input id="fontColorRedInput" type="color" value="#d12d2d">
            <button type="button" id="fontColorRedEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
      </div>

      <div class="color-mode-group" id="fontPerSuitGroup">
        <div class="color-picker-row">
          <span>Spades</span>
          <div class="color-picker">
            <input id="fontColorSpadesInput" type="color" value="#000000">
            <button type="button" id="fontColorSpadesEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Hearts</span>
          <div class="color-picker">
            <input id="fontColorHeartsInput" type="color" value="#d12d2d">
            <button type="button" id="fontColorHeartsEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Clubs</span>
          <div class="color-picker">
            <input id="fontColorClubsInput" type="color" value="#000000">
            <button type="button" id="fontColorClubsEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Diamonds</span>
          <div class="color-picker">
            <input id="fontColorDiamondsInput" type="color" value="#d12d2d">
            <button type="button" id="fontColorDiamondsEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
      </div>

      <div class="field">
        <label for="fontOpacityInput">Opacity</label>
        <input id="fontOpacityInput" type="range" min="0" max="1" step="0.05" value="1">
      </div>

      <div class="field">
        <label for="overlayTypeSelect">Overlay / effect</label>
        <select id="overlayTypeSelect">
          <option value="none">None</option>
          <option value="shadow">Soft shadow</option>
          <option value="glow">Glow</option>
        </select>
      </div>

      <div class="two-col">
        <div class="field">
          <label for="overlayOpacityInput">Glow / shadow opacity</label>
          <input id="overlayOpacityInput" type="range" min="0" max="1" step="0.05" value="0.7">
        </div>
        <div class="field">
          <label for="overlayBlurInput">Glow / shadow blur</label>
          <input id="overlayBlurInput" type="range" min="0" max="40" step="1" value="10">
        </div>
      </div>

      <div class="two-col">
        <div class="field">
          <label for="shadowOffsetXInput">Shadow offset X</label>
          <input id="shadowOffsetXInput" type="number" min="-50" max="50" value="2">
        </div>
        <div class="field">
          <label for="shadowOffsetYInput">Shadow offset Y</label>
          <input id="shadowOffsetYInput" type="number" min="-50" max="50" value="3">
        </div>
      </div>

      <div class="two-col">
        <div class="field">
          <div class="checkbox-row">
            <input type="checkbox" id="outlineCheckbox">
            <label for="outlineCheckbox">Outline / border</label>
          </div>
        </div>
        <div class="field">
          <label for="outlineWidthInput">Outline width</label>
          <input id="outlineWidthInput" type="range" min="0" max="10" step="0.1" value="3">
        </div>
      </div>

      <div class="field">
        <label for="outlinePositionSelect">Outline placement</label>
        <select id="outlinePositionSelect">
          <option value="center">Centered on text</option>
          <option value="outside">Outside only</option>
        </select>
      </div>

      <div class="field">
        <label for="outlineColorInput">Outline color</label>
        <input id="outlineColorInput" type="color" value="#000000">
      </div>
    </div>

    <!-- Suit icon settings -->
    <div class="panel">
      <div class="panel-header collapsible">
        <span>Suit icons </span>
        <div class="header-actions">
          <button type="button" id="resetIconsButton" class="reset-icon-button" title="Reset suit icons">‚Üª</button>
          <span class="chevron">‚ñæ</span>
        </div>
      </div>

      <div class="field">
        <label for="iconPresetSelect">Built-in suit sets</label>
        <select id="iconPresetSelect"></select>
      </div>

      <div class="field">
        <div class="file-input-label">
          Or upload your own sprite sheet (2√ó2 grid, any size)
        </div>
        <input id="iconSheetInput" type="file" accept="image/*">
      </div>

      <div class="field">
        <label for="iconColorModeSelect">Color mode</label>
        <select id="iconColorModeSelect">
          <option value="standard" selected>Standard (no tint)</option>
          <option value="single">Single color</option>
          <option value="bi">Bi-color (red / black)</option>
          <option value="perSuit">Per suit</option>
        </select>
      </div>

      <div class="color-mode-group" id="iconSingleGroup">
        <div class="color-picker-row">
          <span>All suits</span>
          <div class="color-picker">
            <input id="iconColorInput" type="color" value="#000000">
            <button type="button" id="iconColorEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
      </div>

      <div class="color-mode-group" id="iconBiColorGroup">
        <div class="color-picker-row">
          <span>Black suits</span>
          <div class="color-picker">
            <input id="iconColorBlackInput" type="color" value="#000000">
            <button type="button" id="iconColorBlackEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Red suits</span>
          <div class="color-picker">
            <input id="iconColorRedInput" type="color" value="#d12d2d">
            <button type="button" id="iconColorRedEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
      </div>

      <div class="color-mode-group" id="iconPerSuitGroup">
        <div class="color-picker-row">
          <span>Spades</span>
          <div class="color-picker">
            <input id="iconColorSpadesInput" type="color" value="#000000">
            <button type="button" id="iconColorSpadesEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Hearts</span>
          <div class="color-picker">
            <input id="iconColorHeartsInput" type="color" value="#d12d2d">
            <button type="button" id="iconColorHeartsEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Clubs</span>
          <div class="color-picker">
            <input id="iconColorClubsInput" type="color" value="#000000">
            <button type="button" id="iconColorClubsEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
        <div class="color-picker-row">
          <span>Diamonds</span>
          <div class="color-picker">
            <input id="iconColorDiamondsInput" type="color" value="#d12d2d">
            <button type="button" id="iconColorDiamondsEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
      </div>

      <div class="two-col">
        <div class="field">
          <label for="iconOpacityInput">Opacity</label>
          <input id="iconOpacityInput" type="range" min="0" max="1" step="0.05" value="1">
        </div>
        <div class="field">
          <label for="iconScaleInput">Icon scale</label>
          <input id="iconScaleInput" type="range" min="0.4" max="2" step="0.05" value="1">
        </div>
      </div>

      <div class="field">
        <label for="iconOverlayTypeSelect">Overlay / effect</label>
        <select id="iconOverlayTypeSelect">
          <option value="none">None</option>
          <option value="shadow">Soft shadow</option>
          <option value="glow">Glow</option>
        </select>
      </div>

      <div class="two-col">
        <div class="field">
          <label for="iconOverlayOpacityInput">Glow / shadow opacity</label>
          <input id="iconOverlayOpacityInput" type="range" min="0" max="1" step="0.05" value="0.7">
        </div>
        <div class="field">
          <label for="iconOverlayBlurInput">Glow / shadow blur</label>
          <input id="iconOverlayBlurInput" type="range" min="0" max="40" step="1" value="10">
        </div>
      </div>

      <div class="two-col">
        <div class="field">
          <label for="iconShadowOffsetXInput">Shadow offset X</label>
          <input id="iconShadowOffsetXInput" type="number" min="-50" max="50" value="2">
        </div>
        <div class="field">
          <label for="iconShadowOffsetYInput">Shadow offset Y</label>
          <input id="iconShadowOffsetYInput" type="number" min="-50" max="50" value="3">
        </div>
      </div>

      <div class="two-col">
        <div class="field">
          <div class="checkbox-row">
            <input type="checkbox" id="iconOutlineCheckbox">
            <label for="iconOutlineCheckbox">Outline / border</label>
          </div>
        </div>
        <div class="field">
          <label for="iconOutlineWidthInput">Outline width</label>
          <input id="iconOutlineWidthInput" type="range" min="0" max="10" step="0.1" value="3">
        </div>
      </div>

      <div class="field">
        <label for="iconOutlinePositionSelect">Outline placement</label>
        <select id="iconOutlinePositionSelect">
          <option value="center">Centered on icon</option>
          <option value="outside">Outside only</option>
        </select>
      </div>

      <div class="field">
        <label for="iconOutlineColorInput">Outline color</label>
        <input id="iconOutlineColorInput" type="color" value="#000000">
      </div>

      <div class="hint">
        Sprite order (by default): top-left ‚ô†, top-right ‚ô•, bottom-left ‚ô£, bottom-right ‚ô¶.
      </div>
    </div>
	
	<!-- Deck & ranks configuration -->
    <div class="panel collapsed" title=" (Optional) Customize the suits and ranks">
      <div class="panel-header collapsible">
        <span>Deck & ranks</span>
        <div class="header-actions">
          <button type="button" id="resetDeckButton" class="reset-icon-button" title="Reset deck & ranks">‚Üª</button>
          <span class="chevron">‚ñæ</span>
        </div>
      </div>

      <div class="field">
        <label for="customRanksInput">Custom ranks (comma-separated)</label>
        <input id="customRanksInput" type="text"
               placeholder="Leave blank for standard A,2,3,...,K">
        <div class="hint">
          Example: 0,1,2,3,4,5 or A,2,3,4,5,6,7,8,9,10,J,Q,K,X
        </div>
      </div>

      <div class="divider"></div>

      <div class="field-row">
        <div class="checkbox-row">
          <input type="checkbox" id="includeJokersCheckbox">
          <label for="includeJokersCheckbox">Include jokers / wild cards in export</label>
        </div>
      </div>

      <div class="two-col">
        <div class="field">
          <label for="jokerCountInput">Number of jokers</label>
          <input id="jokerCountInput" type="number" min="1" max="8" value="2">
        </div>
        <div class="field">
          <label for="jokerLabelInput">Joker label</label>
          <input id="jokerLabelInput" type="text" value="JOKER">
        </div>
      </div>

      <div class="field-row">
        <div class="checkbox-row">
          <input type="checkbox" id="jokerWildCheckbox">
          <label for="jokerWildCheckbox">Mark jokers as wild</label>
        </div>
      </div>

      <div class="two-col">
        <div class="field">
          <label for="jokerLabelOrientationSelect">Joker label orientation</label>
          <select id="jokerLabelOrientationSelect">
            <option value="horizontal">Horizontal</option>
            <option value="vertical">Vertical</option>
          </select>
        </div>
        <div class="field">
          <label for="jokerFontSizeInput">Joker label size (px)</label>
          <input id="jokerFontSizeInput" type="number" min="24" max="160" value="72">
        </div>
      </div>

      <div class="field">
        <label for="jokerSuitStyleSelect">Joker suit display</label>
        <select id="jokerSuitStyleSelect">
          <option value="centerCircle">Circle around center</option>
          <option value="centerSquare">Square in safe area</option>
          <option value="diamond">Diamond through center</option>
          <option value="belowLabelRow">Row below label</option>
          <option value="centerRowSplit">Centered row (2 up, 2 down)</option>
          <option value="centerColumn">Column through center</option>
          <option value="cornerRows">Corner rows by labels</option>
          <option value="none">No suit icons</option>
        </select>
        <div class="hint">
          Arrangements use the pip guidelines for spacing. Change the pip sliders to fine-tune suit icon positions.
        </div>
      </div>

      <div class="hint">
        Jokers are exported as extra cards with the chosen label and no pip pattern.
      </div>
    </div>

    <!-- Layout and options -->
    <div class="panel collapsed" title="Advanced Layout Features">
      <div class="panel-header collapsible">
        <span>Layout & global options</span>
        <div class="header-actions"><span class="chevron">‚ñæ</span></div>
      </div>

      <div class="field">
        <div class="field-header">
          <label>Card background</label>
          <div class="header-actions">
            <button type="button" id="resetBackgroundButton" class="reset-icon-button" title="Reset background">‚Üª</button>
          </div>
        </div>
        <div class="field-row tight">
          <label class="inline-label" for="backgroundStyleSelect">Style</label>
          <select id="backgroundStyleSelect">
            <option value="solid">Solid</option>
            <option value="vertical">Gradient: Top ‚Üí Bottom</option>
            <option value="horizontal">Gradient: Left ‚Üí Right</option>
            <option value="diagDown">Gradient: Diagonal ‚Üò</option>
            <option value="diagUp">Gradient: Diagonal ‚Üó</option>
            <option value="radial">Radial</option>
          </select>
        </div>

        <div class="color-picker-row">
          <span>Primary</span>
          <div class="color-picker">
            <input id="backgroundPrimaryInput" type="color" value="#ffffff">
            <button type="button" id="backgroundPrimaryEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>

        <div class="color-picker-row" id="backgroundSecondaryGroup">
          <span>Secondary</span>
          <div class="color-picker">
            <input id="backgroundSecondaryInput" type="color" value="#f0f0f0">
            <button type="button" id="backgroundSecondaryEyedropper" class="eyedropper-btn" title="Pick from card">üéØ</button>
          </div>
        </div>
      </div>

      <div class="field">
        <div class="field-header">
          <label>Rank / suit arrangement (corners)</label>
          <div class="header-actions">
            <button type="button" id="resetLayoutButton" class="reset-icon-button" title="Reset rank/suit arrangement">‚Üª</button>
          </div>
        </div>
        <div class="pill-select" id="layoutButtons">
          <button type="button" data-layout="rankAboveSuit" class="active">Rank above suit</button>
          <button type="button" data-layout="suitAboveRank">Suit above rank</button>
          <button type="button" data-layout="sideBySide">Side by side</button>
        </div>
      </div>
	  
      <div class="field-row">
		  <div class="checkbox-row">
			<input type="checkbox" id="mirrorCardCheckbox">
			<label for="mirrorCardCheckbox">Mirror corners for this card</label>
		  </div>
	  
      </div>



      <div class="divider"></div>

      <div class="field">
        <div class="field-header">
          <label>Corner fine-tuning</label>
          <div class="header-actions">
            <button type="button" id="resetCornersButton" class="reset-icon-button" title="Reset corners">‚Üª</button>
          </div>
        </div>
        <div class="two-col">
          <div class="field">
            <label for="rankOffsetXInput">Rank offset X (px)</label>
            <input id="rankOffsetXInput" type="number" step="1" value="0">
          </div>
          <div class="field">
            <label for="rankOffsetYInput">Rank offset Y (px)</label>
            <input id="rankOffsetYInput" type="number" step="1" value="0">
          </div>
        </div>
        <div class="two-col">
          <div class="field">
            <label for="suitOffsetXInput">Suit offset X (px)</label>
            <input id="suitOffsetXInput" type="number" step="1" value="0">
          </div>
          <div class="field">
            <label for="suitOffsetYInput">Suit offset Y (px)</label>
            <input id="suitOffsetYInput" type="number" step="1" value="0">
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="field">

        <div class="field-header">
          <label>Pips and Placement</label>
        </div>

        <div class="field-row">
          <div class="checkbox-row">
            <input type="checkbox" id="showPipsCheckbox" checked>
            <label for="showPipsCheckbox">Show standard pip pattern on body</label>
          </div>
        </div>

        <div id="pipControlsGroup">
          <div class="field-header">
            <label>Pip vertical positions (safe-area %)</label>
            <div class="header-actions"><button type="button" id="resetPipPositionsButton" class="reset-icon-button" title="Reset pip vertical positions">‚Üª</button></div>
          </div>

          <div class="pip-slider-row">
            <span>Top <button type="button" id="linkPipOuterButton" class="link-icon-button" title="Link top & bottom">üîó</button></span>
            <input id="pipTopInput" type="range" min="0" max="100" step="1" value="30">
            <span class="pip-value" id="pipTopValue">30</span>
          </div>

          <div class="pip-slider-row">
            <span>Inner top <button type="button" id="linkPipInnerButton" class="link-icon-button" title="Link inner top & bottom">üîó</button></span>
            <input id="pipInnerTopInput" type="range" min="0" max="100" step="1" value="40">
            <span class="pip-value" id="pipInnerTopValue">40</span>
          </div>

          <div class="pip-slider-row">
            <span>Center <button type="button" id="linkPipCenterButton" class="link-icon-button" title="Link all to center">üîó</button></span>
            <input id="pipCenterInput" type="range" min="0" max="100" step="1" value="50">
            <span class="pip-value" id="pipCenterValue">50</span>
          </div>

          <div class="pip-slider-row">
            <span>Inner bottom</span>
            <input id="pipInnerBottomInput" type="range" min="0" max="100" step="1" value="60">
            <span class="pip-value" id="pipInnerBottomValue">60</span>
          </div>

          <div class="pip-slider-row">
            <span>Bottom</span>
            <input id="pipBottomInput" type="range" min="0" max="100" step="1" value="70">
            <span class="pip-value" id="pipBottomValue">70</span>
          </div>

          <div class="hint">
            These control the vertical rows for pip layouts (2‚Äì10). Values are percentages of the safe area height.
          </div>
        </div>
      </div>
    </div>

    

    <!-- Export -->
    <div class="panel">
      <div class="panel-header">
        <span>Export</span>
        <span id="saveProgressBadge" class="badge clickable">üíæ Save Progress</span>
        <span id="importProgressBadge" class="badge clickable">üóÉÔ∏è Import</span>
      </div>

      <!-- Hidden file input used by the Import badge -->
      <input
        type="file"
        id="importProgressInput"
        accept=".zip"
        style="display: none;"
      />

      <div class="pill-button-stack">

		  <!-- ZIP BUTTON -->
		  <button type="button" id="exportDeckButton" class="pill-btn pill-zip">
			<span class="pill-icon">üì¶</span>
			<span>Export as ZIP File</span>
		  </button>

		  <!-- TGC BUTTON -->
		  <button type="button" id="tgcExportOpenButton" class="pill-btn pill-tgc">
			<img src="assets/tgc.png" class="pill-img-icon" />
			<span>Export to The Game Crafter</span>
		  </button>

		</div>

      <div class="small-text">
        Exports all configured ranks √ó suits plus optional Jokers as PNG files (825√ó1125 px, 80 px bleed).
      </div>
    </div>
  </div>

  <div class="main">
    <div class="preview-wrapper">
      <div class="preview-card">
        <div class="preview-info">
		
		  <button type="button" id="prevCardBtn" class="icon-button">‚ü®</button>
		  <div class="badge">
			<span>Dimensions</span>
			<span id="canvasSizeInfo"></span>
		  </div>
		  <div class="badge">
			<span>Safe zone</span>
			<span id="safeZoneInfo"></span>
		  </div>
		  

		  <!-- NEW: guideline toggle moved here -->
		  <div class="badge">
			<input type="checkbox" id="showGuidelinesCheckbox" checked>
			<label for="showGuidelinesCheckbox">Show guidelines</label>
		  </div>
		  
		  <button type="button" id="downloadCardButton" class="icon-button" title="Download current card">
			‚¨áÔ∏è
		  </button>
		  
		  <div class="badge">
			  <span id="autosaveStatus" class="autosave-badge">‚Äî</span>
			</div>

		  
		  
		  
		  <button type="button" id="nextCardBtn" class="icon-button">‚ü©</button>
		</div>


        <canvas id="cardCanvas" width="825" height="1125"></canvas>

      </div>
    </div>
  </div>
</div>

<!-- HELP MODAL -->
<div id="helpModal" class="modal modal--wide hidden" role="dialog" aria-modal="true" aria-labelledby="helpModalTitle">
  <div class="modal-content help-modal">
    <button id="closeHelpModal" class="modal-close" aria-label="Close help">√ó</button>
    <div class="help-modal-header">
      <h3 id="helpModalTitle">Help</h3>
    </div>
    <div class="help-modal-body">
      <div class="help-topic-list" id="helpTopicList"></div>
      <div class="help-content" id="helpContent" tabindex="0"></div>
    </div>
  </div>
</div>

<!-- BUG REPORT MODAL -->
<div id="bugReportModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="bugModalTitle">
  <div class="modal-content bug-modal">
    <button id="closeBugModal" class="modal-close" aria-label="Close bug report">√ó</button>
    <h3 id="bugModalTitle">Report a bug</h3>
    <form id="bugReportForm">
      <div class="field">
        <label for="bugSummary">Short summary *</label>
        <input id="bugSummary" type="text" name="summary" required maxlength="160" placeholder="Brief description" />
      </div>
      <div class="field">
        <label for="bugDetails">What happened</label>
        <textarea id="bugDetails" name="details" rows="3" placeholder="Optional details"></textarea>
      </div>
      <div class="field">
        <label for="bugSteps">Steps to reproduce</label>
        <textarea id="bugSteps" name="steps" rows="3" placeholder="Optional steps"></textarea>
      </div>

      <details class="tech-details">
        <summary>Technical details</summary>
        <textarea id="bugTechnicalDetails" readonly rows="8"></textarea>
      </details>

      <div class="field-row">
        <div class="checkbox-row">
          <input type="checkbox" id="includeAppState" checked />
          <label for="includeAppState">Include current app state</label>
        </div>
      </div>

      <div class="bug-modal__footer">
        <div class="modal-status" id="bugStatus"></div>
        <div class="modal-status-link" id="bugStatusLink"></div>
        <a href="#" id="bugFallbackLink" class="hidden" target="_blank" rel="noopener">Open GitHub issue manually</a>
        <div class="button-row">
          <button type="submit" class="primary" id="bugSubmit">Submit</button>
          <button type="button" class="secondary" id="bugCancel">Cancel</button>
        </div>
      </div>
    </form>
  </div>
</div>

<!-- FONT BROWSER MODAL -->
<div id="fontModal" class="modal modal--wide hidden">
  <div class="modal-content">
    <button id="closeFontModal" class="modal-close">√ó</button>
    <h3>Select Google Font</h3>
    
    <input id="fontSearch" type="text" placeholder="Search Google Fonts‚Ä¶">

    <div id="fontList" class="font-list"></div>

  </div>
</div>

<!-- BULK FACE IMAGE LOADER MODAL -->
<div id="bulkFaceModal" class="modal hidden">
  <div class="modal-content">
    <button id="bulkCloseBtn" class="modal-close">√ó</button>
    <h3>Bulk Load Face Images</h3>

    <p class="small-text">
      Select multiple images. The system tries to extract rank & suit from filenames.
      You can adjust mappings before applying.
    </p>

    <!-- multi-file input -->
    <input
      id="bulkFaceInput"
      type="file"
      accept="image/*"
      multiple
      style="margin: 10px 0;"
    />

    <!-- mapping table -->
    <table class="bulk-map-table">
      <thead>
        <tr>
          <th>Preview</th>
          <th>Rank</th>
          <th>Suit</th>
        </tr>
      </thead>
      <tbody id="bulkFaceTable"></tbody>
    </table>

    <!-- action buttons -->
    <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
      <button id="bulkApplyButton" class="primary">Apply</button>
      <button id="bulkCancelButton" class="secondary">Cancel</button>
    </div>

  </div>
</div>


<!-- =========================================
     TGC EXPORT MODAL
========================================= -->
<div id="tgcModal" class="modal modal--wide hidden">
  <div class="modal-content">

    <h3>
      <img src="assets/tgc.png" class="tgc-title-logo" />
      Export to The Game Crafter
    </h3>
    <button id="closeTgcModal" class="modal-close">√ó</button>


    <!-- =====================================================
         LOGIN PANEL
    ====================================================== -->
    <div id="tgcLoginPanel" class="tgc-section">
      <button id="tgcLoginButton" class="pill-btn pill-tgc">
        <img src="assets/tgc.png" class="pill-img-icon" />
        <span>Log in with The Game Crafter</span>
      </button>
    </div>


    <!-- =====================================================
         EXPORT PANEL (hidden until login)
    ====================================================== -->
    <div id="tgcExportPanel" class="tgc-section hidden">


      <!-- =====================================================
           PHASE 1: Designer & Game Selection
      ====================================================== -->
      <div id="tgcPhase1" class="tgc-section-block">

  <div class="tgc-section-label">Designer</div>

  <div class="field-row">
    <select id="tgcDesignerSelect"
            class="tgc-input"
            style="max-width: 10em;"></select>

    <div id="tgcDesignerLoading" class="tgc-inline-loading hidden">
      <span class="tgc-spinner" aria-hidden="true"></span>
      <span>Loading designers‚Ä¶</span>
    </div>

    <!-- SEARCH + GAME LIST STACK -->
    <div class="tgc-game-stack">
      <input id="tgcGameSearch"
             type="text"
             placeholder="Type to find game‚Ä¶"
             class="tgc-input">

      <select id="tgcGameSelect" size="6"></select>
    </div>

    <button id="tgcCreateGameButton"
            class="secondary small tgc-plus-btn"
            title="Create new game">+</button>

    <div id="tgcGameLoading" class="tgc-inline-loading hidden">
      <span class="tgc-spinner" aria-hidden="true"></span>
      <span>Loading games‚Ä¶</span>
    </div>
  </div>

  <!-- Create new game panel -->
  <div id="tgcNewGameRow" class="tgc-subpanel hidden">
    <input id="tgcNewGameName"
           type="text"
           placeholder="New game name‚Ä¶">
    <button id="tgcConfirmCreateGame"
            class="primary small">Create</button>
  </div>

</div>




      <!-- =====================================================
           PHASE 2: Locked Designer | Game + Deck Selection
      ====================================================== -->
      <div id="tgcPhase2" class="tgc-section-block hidden">

        <div class="tgc-section-label">Selected</div>

        <div class="field-row" style="align-items:center;">

          <div id="tgcLockedInfo" class="tgc-locked-pill">
            <!-- JS populates: Designer Name | Game Name -->
          </div>

          <button id="tgcRestartButton"
                  class="secondary small"
                  style="margin-left:8px;"
                  title="Change game">‚ôªÔ∏è</button>

        </div>

        <!-- Deck Select -->
        <div class="tgc-section-label" style="margin-top:16px;">Deck</div>

        <div class="field-row">
          <select id="tgcDeckSelect"
                  class="tgc-input"
                  style="flex:1;"></select>

          <button id="tgcCreateDeckButton"
                  class="secondary small tgc-plus-btn"
                  title="Create new deck">+</button>

          <div id="tgcDeckLoading" class="tgc-inline-loading hidden">
            <span class="tgc-spinner" aria-hidden="true"></span>
            <span>Loading decks‚Ä¶</span>
          </div>
        </div>

        <!-- Create new deck panel -->
        <div id="tgcNewDeckRow" class="tgc-subpanel hidden">
          <input id="tgcNewDeckName"
                 type="text"
                 placeholder="New deck name‚Ä¶">
          <button id="tgcConfirmCreateDeck"
                  class="primary small">Create</button>
        </div>
      </div>



      <!-- =====================================================
           CARD PREVIEW GRID + REFRESH BUTTON
      ====================================================== -->

      <button id="tgcRefreshPreviews"
              class="secondary small"
              style="margin:10px 0 4px 0;">
        ‚Üª Refresh Previews
      </button>

      <div id="tgcPreviewLoading" class="tgc-inline-loading hidden">
        <span class="tgc-spinner" aria-hidden="true"></span>
        <span>Loading previews‚Ä¶</span>
      </div>

      <div id="tgcPreviewPanel"
           class="tgc-preview-grid"
           style="max-height: 250px; overflow-y: auto;">
      </div>



      <!-- =====================================================
           ‚òÖ NEW: Collision Behavior Toggle Badge
      ====================================================== -->

      <div style="margin-top:16px; margin-bottom:8px; display:flex; align-items:center;">
        <span style="font-size:13px; margin-right:8px; opacity:.8;">
          Collision Behavior:
        </span>

        <div id="tgcCollisionSetting"
             style="
               display:inline-block;
               padding:4px 10px;
               background:#444;
               color:#fff;
               border-radius:6px;
               cursor:pointer;
               user-select:none;
               font-size:12px;
             ">
          Replace Existing
        </div>
      </div>



      <!-- =====================================================
           UPLOAD BUTTON
      ====================================================== -->
      <button id="tgcExportButton"
              class="pill-btn pill-tgc"
              style="margin-top: 10px;">
        Upload Cards to This Deck
      </button>



      <!-- =====================================================
           UPLOAD PROGRESS
      ====================================================== -->

      <!-- Progress bar -->
      <div id="tgcExportProgressContainer"
           class="tgc-progress-container hidden">
        <div id="tgcExportProgressBar" class="tgc-progress-bar"></div>
      </div>

      <!-- Cancel button -->
      <button id="tgcCancelExportButton"
              class="hidden"
              style="width:100%; margin-top:12px;">
        Cancel Upload
      </button>

      


    </div> <!-- END EXPORT PANEL -->

  </div>
</div>



<!-- =========================================
     CARD CONFLICT MODAL (NEW)
========================================= -->
<div id="tgcConflictModal" class="modal hidden">
  <div class="modal-content small">

    <h3 id="tgcConflictTitle" style="margin-bottom:10px;">
      <!-- JS inserts: Card Exists: Ace of Spades -->
    </h3>

    <p>This card already exists. What would you like to do?</p>

    <div style="display:flex; gap:10px; margin-top:15px; justify-content:center;">
      <button id="tgcConflictReplace" class="primary">Replace</button>
      <button id="tgcConflictSkip" class="secondary">Skip</button>
      <button id="tgcConflictCopy" class="primary">Create Copy</button>
    </div>

  </div>
</div>


<!-- =========================================
     GLOBAL PROGRESS OVERLAY
========================================= -->
<div id="progressOverlay" class="progress-overlay hidden">
  <div class="progress-panel">

    <div id="progressOverlayTitle" class="progress-title">
      Processing‚Ä¶
    </div>

    <!-- NEW: operation text -->
    <div id="progressOperation" class="progress-operation">
      Initializing‚Ä¶
    </div>

    <div class="progress-bar-shell">
      <div id="progressBarFill" class="progress-bar-fill"></div>
    </div>

    <div class="progress-meta">
      <span id="progressCurrent">0</span>
      /
      <span id="progressTotal">0</span>
    </div>

    <!-- NEW: result / error output -->
    <div id="progressResult" class="progress-result hidden"></div>

    <button
      id="progressCancel"
      class="secondary small progress-cancel-btn">
      Cancel
    </button>

  </div>
</div>

<div id="fullResetModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="fullResetModalTitle">
  <div class="modal-content">
    <h3 id="fullResetModalTitle">Start Over?</h3>
    <p>This will clear all selected images, custom icons, ability text, and other saved settings.</p>
    <div class="modal-actions">
      <button type="button" id="cancelFullResetButton" class="secondary">Cancel</button>
      <button type="button" id="confirmFullResetButton" class="danger">OK</button>
    </div>
  </div>
</div>


<!-- Main module -->
<script type="module" src="scripts/main.js"></script>

</body>
</html>